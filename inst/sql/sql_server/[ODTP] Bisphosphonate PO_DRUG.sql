-- BP PO
DELETE FROM @target_database_schema.@target_cohort_table where cohort_definition_id = @target_cohort_id;
INSERT INTO @target_database_schema.@target_cohort_table (cohort_definition_id, subject_id, drug_concept_id, cohort_start_date, cohort_end_date, days_supply, duration)
select @target_cohort_id as cohort_definition_id, d.person_id, d.drug_concept_id, d.drug_exposure_start_date, d.drug_exposure_end_date, d.days_supply, d.duration
from (
  select de.*, 1 as 'duration'
  FROM @cdm_database_schema.DRUG_EXPOSURE de
  WHERE (drug_source_value like '%644500230%'
	or drug_source_value like '%657200460%'
	or drug_source_value like '%655500710%'
	or drug_source_value like '%A02003951%'
	or drug_source_value like '%A09703641%'
	or drug_source_value like '%A50703171%'
	or drug_source_value like '%A78800531%'
	or drug_source_value like '%E09060741%'
	or drug_source_value like '%657200450%'
	or drug_source_value like '%644500240%'
	or drug_source_value like '%A02003941%'
	or drug_source_value like '%A09703631%'
	or drug_source_value like '%642103130%'
	or drug_source_value like '%643304750%'
	or drug_source_value like '%652100900%'
	or drug_source_value like '%B07404671%')
	and days_supply >= 28
union all
  select de.*, 7 as 'duration'
  FROM @cdm_database_schema.DRUG_EXPOSURE de
  WHERE (drug_source_value like '%643304010%'
	or drug_source_value like '%649804050%'
	or drug_source_value like '%647303660%'
	or drug_source_value like '%647500030%'
	or drug_source_value like '%661306120%'
	or drug_source_value like '%52700280%'
	or drug_source_value like '%654201280%'
	or drug_source_value like '%653403041%'
	or drug_source_value like '%643501790%'
	or drug_source_value like '%655500570%'
	or drug_source_value like '%668900380%'
	or drug_source_value like '%697100010%'
	or drug_source_value like '%53600910%'
	or drug_source_value like '%652604800%'
	or drug_source_value like '%644806040%'
	or drug_source_value like '%645902160%'
	or drug_source_value like '%693902310%'
	or drug_source_value like '%653404511%'
	or drug_source_value like '%670600660%'
	or drug_source_value like '%640900650%'
	or drug_source_value like '%653000980%'
	or drug_source_value like '%654701010%'
	or drug_source_value like '%679800310%'
	or drug_source_value like '%649402690%'
	or drug_source_value like '%661901370%'
	or drug_source_value like '%646800300%'
	or drug_source_value like '%A03805801%'
	or drug_source_value like '%645202710%'
	or drug_source_value like '%641600770%'
	or drug_source_value like '%650204530%'
	or drug_source_value like '%648504020%'
	or drug_source_value like '%643701650%'
	or drug_source_value like '%652300460%'
	or drug_source_value like '%649605220%'
	or drug_source_value like '%670101390%'
	or drug_source_value like '%683601450%'
	or drug_source_value like '%690300790%'
	or drug_source_value like '%641802230%'
	or drug_source_value like '%621800930%'
	or drug_source_value like '%649501910%'
	or drug_source_value like '%654301780%'
	or drug_source_value like '%694000310%'
	or drug_source_value like '%655402100%'
	or drug_source_value like '%689101020%'
	or drug_source_value like '%669604920%'
	or drug_source_value like '%643200650%'
	or drug_source_value like '%693201130%'
	or drug_source_value like '%623005820%'
	or drug_source_value like '%663602830%'
	or drug_source_value like '%671803390%'
	or drug_source_value like '%625800450%'
	or drug_source_value like '%669902660%'
	or drug_source_value like '%646200230%'
	or drug_source_value like '%647205470%'
	or drug_source_value like '%664601020%'
	or drug_source_value like '%647801610%'
	or drug_source_value like '%644000520%'
	or drug_source_value like '%648200960%'
	or drug_source_value like '%665000690%'
	or drug_source_value like '%643105030%'
	or drug_source_value like '%650301160%'
	or drug_source_value like '%699801590%'
	or drug_source_value like '%657501210%'
	or drug_source_value like '%658600720%'
	or drug_source_value like '%657302000%'
	or drug_source_value like '%658106500%'
	or drug_source_value like '%655601330%'
	or drug_source_value like '%A00306591%'
	or drug_source_value like '%A01207491%'
	or drug_source_value like '%A01306731%'
	or drug_source_value like '%A01402391%'
	or drug_source_value like '%A02704791%'
	or drug_source_value like '%A03006081%'
	or drug_source_value like '%A03505501%'
	or drug_source_value like '%A03805801%'
	or drug_source_value like '%A04304361%'
	or drug_source_value like '%A05404911%'
	or drug_source_value like '%A05607921%'
	or drug_source_value like '%A06502401%'
	or drug_source_value like '%A06653831%'
	or drug_source_value like '%A06703931%'
	or drug_source_value like '%A07104681%'
	or drug_source_value like '%A08504471%'
	or drug_source_value like '%A10004041%'
	or drug_source_value like '%A10703811%'
	or drug_source_value like '%A11103910%'
	or drug_source_value like '%A11204211%'
	or drug_source_value like '%A12202661%'
	or drug_source_value like '%A12603911%'
	or drug_source_value like '%A12703451%'
	or drug_source_value like '%A12804371%'
	or drug_source_value like '%A13302401%'
	or drug_source_value like '%A15204811%'
	or drug_source_value like '%A15603511%'
	or drug_source_value like '%A16604351%'
	or drug_source_value like '%A17001211%'
	or drug_source_value like '%A19203331%'
	or drug_source_value like '%A20602781%'
	or drug_source_value like '%A21404141%'
	or drug_source_value like '%A22401711%'
	or drug_source_value like '%A22607041%'
	or drug_source_value like '%A23503391%'
	or drug_source_value like '%A25005321%'
	or drug_source_value like '%A25803451%'
	or drug_source_value like '%A26401251%'
	or drug_source_value like '%A29503531%'
	or drug_source_value like '%A31805061%'
	or drug_source_value like '%A32202661%'
	or drug_source_value like '%A33203101%'
	or drug_source_value like '%A34003321%'
	or drug_source_value like '%A35104451%'
	or drug_source_value like '%A36705671%'
	or drug_source_value like '%A42900481%'
	or drug_source_value like '%A45900521%'
	or drug_source_value like '%A50703461%'
	or drug_source_value like '%A59500071%'
	or drug_source_value like '%A59500091%'
	or drug_source_value like '%A60300241%'
	or drug_source_value like '%A60603021%'
	or drug_source_value like '%A62755371%'
	or drug_source_value like '%A79100531%'
	or drug_source_value like '%A82800181%'
	or drug_source_value like '%E02670321%'
	or drug_source_value like '%622801280%'
	or drug_source_value like '%623006470%'
	or drug_source_value like '%625200160%'
	or drug_source_value like '%629701920%'
	or drug_source_value like '%640004850%'
	or drug_source_value like '%640005790%'
	or drug_source_value like '%640902430%'
	or drug_source_value like '%641606500%'
	or drug_source_value like '%641800230%'
	or drug_source_value like '%641904630%'
	or drug_source_value like '%642103120%'
	or drug_source_value like '%642103130%'
	or drug_source_value like '%652104500%'
	or drug_source_value like '%652100910%'
	or drug_source_value like '%642202580%'
	or drug_source_value like '%642303060%'
	or drug_source_value like '%642401990%'
	or drug_source_value like '%642505320%'
	or drug_source_value like '%642704290%'
	or drug_source_value like '%642801860%'
	or drug_source_value like '%642902870%'
	or drug_source_value like '%643105180%'
	or drug_source_value like '%643504110%'
	or drug_source_value like '%643902070%'
	or drug_source_value like '%644306200%'
	or drug_source_value like '%644702930%'
	or drug_source_value like '%644803240%'
	or drug_source_value like '%644912320%'
	or drug_source_value like '%645102850%'
	or drug_source_value like '%645207310%'
	or drug_source_value like '%645302340%'
	or drug_source_value like '%645402540%'
	or drug_source_value like '%645602340%'
	or drug_source_value like '%645701450%'
	or drug_source_value like '%645903560%'
	or drug_source_value like '%646002650%'
	or drug_source_value like '%646202490%'
	or drug_source_value like '%648102550%'
	or drug_source_value like '%648203400%'
	or drug_source_value like '%648504750%'
	or drug_source_value like '%648602160%'
	or drug_source_value like '%649001490%'
	or drug_source_value like '%649101530%'
	or drug_source_value like '%649702500%'
	or drug_source_value like '%649804340%'
	or drug_source_value like '%650202660%'
	or drug_source_value like '%650301780%'
	or drug_source_value like '%651600810%'
	or drug_source_value like '%651804950%'
	or drug_source_value like '%651903370%'
	or drug_source_value like '%652601680%'
	or drug_source_value like '%653004400%'
	or drug_source_value like '%653102070%'
	or drug_source_value like '%653401610%'
	or drug_source_value like '%654303670%'
	or drug_source_value like '%655200060%'
	or drug_source_value like '%657201250%'
	or drug_source_value like '%657305310%'
	or drug_source_value like '%657803180%'
	or drug_source_value like '%658001880%'
	or drug_source_value like '%658602100%'
	or drug_source_value like '%660702540%'
	or drug_source_value like '%661602550%'
	or drug_source_value like '%661902130%'
	or drug_source_value like '%662502120%'
	or drug_source_value like '%668400320%'
	or drug_source_value like '%669802260%'
	or drug_source_value like '%670001120%'
	or drug_source_value like '%670302210%'
	or drug_source_value like '%670400980%'
	or drug_source_value like '%670604180%'
	or drug_source_value like '%671804160%'
	or drug_source_value like '%674400910%'
	or drug_source_value like '%684500260%'
	or drug_source_value like '%689001100%'
	or drug_source_value like '%690302340%'
	or drug_source_value like '%693201140%'
	or drug_source_value like '%693901000%'
	or drug_source_value like '%694204750%'
	or drug_source_value like '%697100030%'
	or drug_source_value like '%698000980%'
	or drug_source_value like '%A07705281%'
	or drug_source_value like '%A12804941%'
	or drug_source_value like '%A00358501%'
	or drug_source_value like '%A00702121%'
	or drug_source_value like '%A00803151%'
	or drug_source_value like '%A01208931%'
	or drug_source_value like '%A01307341%'
	or drug_source_value like '%A01403031%'
	or drug_source_value like '%A01559741%'
	or drug_source_value like '%A02108051%'
	or drug_source_value like '%A02352001%'
	or drug_source_value like '%A02507671%'
	or drug_source_value like '%A02706171%'
	or drug_source_value like '%A03405441%'
	or drug_source_value like '%A03603021%'
	or drug_source_value like '%A04204881%'
	or drug_source_value like '%A04507191%'
	or drug_source_value like '%A04705791%'
	or drug_source_value like '%A04804931%'
	or drug_source_value like '%A05003411%'
	or drug_source_value like '%A05303001%'
	or drug_source_value like '%A05405851%'
	or drug_source_value like '%A05706371%'
	or drug_source_value like '%A06104191%'
	or drug_source_value like '%A06907201%'
	or drug_source_value like '%A07208841%'
	or drug_source_value like '%A07705281%'
	or drug_source_value like '%A08505021%'
	or drug_source_value like '%A08603591%'
	or drug_source_value like '%A08803911%'
	or drug_source_value like '%A09306361%'
	or drug_source_value like '%A09704221%'
	or drug_source_value like '%A10004411%'
	or drug_source_value like '%A10704091%'
	or drug_source_value like '%A11656001%'
	or drug_source_value like '%A11801491%'
	or drug_source_value like '%A12605031%'
	or drug_source_value like '%A12804941%'
	or drug_source_value like '%A12951050%'
	or drug_source_value like '%A13153291%'
	or drug_source_value like '%A13306241%'
	or drug_source_value like '%A15205121%'
	or drug_source_value like '%A15301821%'
	or drug_source_value like '%A15603941%'
	or drug_source_value like '%A15902611%'
	or drug_source_value like '%A16205661%'
	or drug_source_value like '%A18953271%'
	or drug_source_value like '%A20403571%'
	or drug_source_value like '%A20756061%'
	or drug_source_value like '%A21405151%'
	or drug_source_value like '%A22607641%'
	or drug_source_value like '%A23403711%'
	or drug_source_value like '%A25005981%'
	or drug_source_value like '%A27804401%'
	or drug_source_value like '%A29506621%'
	or drug_source_value like '%A31804911%'
	or drug_source_value like '%A35104821%'
	or drug_source_value like '%A37804131%'
	or drug_source_value like '%A43903871%'
	or drug_source_value like '%A47404431%'
	or drug_source_value like '%A66303221%'
	or drug_source_value like '%A82300121%'
	or drug_source_value like '%B07404681%')
	and days_supply >= 4
union all
  select de.*, 30 as 'duration'
  FROM @cdm_database_schema.DRUG_EXPOSURE de
  WHERE (drug_source_value like '%625200540%'
	or drug_source_value like '%626900310%'
	or drug_source_value like '%628800520%'
	or drug_source_value like '%641704410%'
	or drug_source_value like '%642003080%'
	or drug_source_value like '%642904480%'
	or drug_source_value like '%643703610%'
	or drug_source_value like '%644308590%'
	or drug_source_value like '%644501860%'
	or drug_source_value like '%644602670%'
	or drug_source_value like '%645403680%'
	or drug_source_value like '%645604140%'
	or drug_source_value like '%645905420%'
	or drug_source_value like '%645000310%'
	or drug_source_value like '%646203670%'
	or drug_source_value like '%648506730%'
	or drug_source_value like '%648602510%'
	or drug_source_value like '%649506250%'
	or drug_source_value like '%650102490%'
	or drug_source_value like '%650204450%'
	or drug_source_value like '%650303090%'
	or drug_source_value like '%651203800%'
	or drug_source_value like '%652105740%'
	or drug_source_value like '%652301120%'
	or drug_source_value like '%654004120%'
	or drug_source_value like '%655403010%'
	or drug_source_value like '%656003260%'
	or drug_source_value like '%657202450%'
	or drug_source_value like '%657502780%'
	or drug_source_value like '%657804920%'
	or drug_source_value like '%664602070%'
	or drug_source_value like '%665001720%'
	or drug_source_value like '%669804200%'
	or drug_source_value like '%670103390%'
	or drug_source_value like '%670606180%'
	or drug_source_value like '%670701640%'
	or drug_source_value like '%671703940%'
	or drug_source_value like '%674401320%'
	or drug_source_value like '%697100370%'
	or drug_source_value like '%698502260%'
	or drug_source_value like '%E01840821%'
	or drug_source_value like '%53300070%'
	or drug_source_value like '%625200790%'
	or drug_source_value like '%628900630%'
	or drug_source_value like '%640005770%'
	or drug_source_value like '%642103870%'
	or drug_source_value like '%642403470%'
	or drug_source_value like '%642506210%'
	or drug_source_value like '%642705420%'
	or drug_source_value like '%643305680%'
	or drug_source_value like '%643505490%'
	or drug_source_value like '%644307910%'
	or drug_source_value like '%644913010%'
	or drug_source_value like '%645203450%'
	or drug_source_value like '%645207300%'
	or drug_source_value like '%645403390%'
	or drug_source_value like '%645702130%'
	or drug_source_value like '%648103450%'
	or drug_source_value like '%648203310%'
	or drug_source_value like '%648506260%'
	or drug_source_value like '%649102980%'
	or drug_source_value like '%649404730%'
	or drug_source_value like '%649702470%'
	or drug_source_value like '%649805050%'
	or drug_source_value like '%650302690%'
	or drug_source_value like '%651805570%'
	or drug_source_value like '%652602900%'
	or drug_source_value like '%652903120%'
	or drug_source_value like '%653102330%'
	or drug_source_value like '%653102330%'
	or drug_source_value like '%653401980%'
	or drug_source_value like '%653701880%'
	or drug_source_value like '%653804430%'
	or drug_source_value like '%655604220%'
	or drug_source_value like '%659900580%'
	or drug_source_value like '%665506010%'
	or drug_source_value like '%668901770%'
	or drug_source_value like '%669501060%'
	or drug_source_value like '%670401250%'
	or drug_source_value like '%670605380%'
	or drug_source_value like '%684500480%'
	or drug_source_value like '%694204930%'
	or drug_source_value like '%697100580%'
	or drug_source_value like '%652103880%'
	or drug_source_value like '%A33203581%'
	or drug_source_value like '%E01300571%')
	and days_supply >= 1
  ) d;
